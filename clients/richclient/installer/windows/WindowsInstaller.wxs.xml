<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>

    <!-- TODO: Version dynamisch setzen, aber Achtung: diese muss das Format w.x.y.z. haben. -->
    
    <Product Name='Open eCard Rich Client' Id='*' Language='1033'
        Version='1.0.0.0' Manufacturer='openecard.org'>


        <Package Id='*' InstallerVersion='200' Compressed='yes' />

        <Media Id='1' Cabinet='OpenECardRichClientApp.cab' EmbedCab='yes' />

        
        <Directory Id='TARGETDIR' Name='SourceDir'>
            <Directory Id='ProgramFilesFolder'>
                <Directory Id="OpenECard" Name="Open eCard">
                    <Directory Id='INSTALLDIR' Name='richclient-@VERSION@'>
                        <Component Id='MainExecutable' Guid='*'>
                            <File Id='BatchFile' Name='run.bat' Source='run.bat' Vital='yes' KeyPath='yes' >

                                <Shortcut Id="startmenu" Directory="ProgramMenuDir" 
                                          Name="Open eCard Rich Client @VERSION@" WorkingDirectory='INSTALLDIR' 
                                          Icon="OpenECard.ico" IconIndex="0" Advertise='yes' />
                            </File>
                            <RemoveFolder Id="INSTALLDIR" On="uninstall" />
                        </Component>
                        <Directory Id="libdir" Name="lib">
                            <Component Id='lib' Guid='8b5a020c-3a86-4d61-a933-b54575b0d0c4'>
                                @ALL_JARS@
                            </Component>
                        </Directory>
                    </Directory>
                </Directory>
            </Directory>

            <Directory Id="ProgramMenuFolder">
                <Directory Id="ProgramMenuDir" Name="Open eCard">
                    <Component Id='ProgramMenuDir' Guid='*'>
                        <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
                        <RegistryValue Root='HKCU' Key='SOFTWARE\OpenECard\RichClient' Type='string' Value='' KeyPath='yes' />
                    </Component>
                </Directory>
            </Directory>

            <Directory Id="DesktopFolder" Name="Desktop" />
        </Directory>
        
        
        <Icon Id="OpenECard.ico" SourceFile="Open-eCard-Logo.ico" />
        <Property Id="ARPPRODUCTICON" Value="OpenECard.ico" />
        
        <Feature Id='Complete' Level="1">
            <ComponentRef Id='MainExecutable' />
            <ComponentRef Id="lib" />
            <ComponentRef Id="ProgramMenuDir" />
        </Feature>
        
        
        <!-- WixVariable Id="WixUIBannerBmp" Value="Open-eCard-Logo.bmp" /-->  
        <!-- WixVariable Id="WixUIDialogBmp" Value="Open-eCard-Logo.bmp" /-->  
        <!-- WixVariable Id="WixUILicenseRtf" Value="OurLicense.rtf" /-->  
    </Product>
</Wix>